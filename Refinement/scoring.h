/*
Atom types, according to CHARMM (used for VdW interactions) :
   Hydrogens :
           1.  H  (H which can H-bond to neutral atom)
           2.  HC (H which can H-bond to charged atom)
           3.  HA (aliphatic hydrogen)
           4.  HT (TIPS3P water hydrogen)
           5.  LP (ST2 lone pair)
   Carbons
           6.  CT   (aliphatic carbon)
           7.  C    (carbonyl carbon)
           8.  CH1E (extended carbon, with 1 hydrogen)
           9.  CH2E (extended carbon, with 2 hydrogens)
           10. CH3E (extended carbon, with 3 hydrogens)
           11. CR1E (ring carbons)
           12. CM   (C in carbonmonoxide)
   Nitrogens
           13. N   (peptide N with no hydrogen atoms attached)
           14. NR  (N in aromatic ring with no hydrogen atoms)
           15. NP  (Pyrole N)
           16. NH1 (Peptide N bound to one hydrogen)
           17. NH2 (Peptide N bound to two hydrogen atoms)
           18. NH3 (Peptide N bound to three hydrogen atoms)
           19. NC  (Guanidinium N bound to 2 hydrogens)

   Oxygens
           20. O   (carbonyl O)
           21. OC  (carboxy O)
           22. OH1 (hydroxy O)
           23. OH2 (ST2 water oxygen)
           24. OM  (O in carbonmonoxide)
           25. OT  (TIPS3P water oxygen)
           26. OS  (esther oxygen)

   Sulfurs
           27. S   (sulfur)
           28. SH1E (extended atom S with one hydrogen)
   
   Iron
           29. FE  (iron)
*/

#ifndef _SCORING_H_
#define _SCORING_H_

#include "atom.h"
#include "Neighbour.h"
#include "utils.h"
#include "soroban_score.h"
#include "contact.h"
#include <vector>

const double ZHANG_ACP[18][18] ={
	{-0.724,-0.903,-0.722,-0.322,-0.331,-0.603,1.147,0.937,0.752,0.502,0.405,0.495,-0.116,-0.092,-0.412,-0.499,-1.005,-2.060},
	{-0.903,-0.842,-0.850,-0.332,-0.365,-0.531,1.139,0.918,0.852,0.452,0.445,0.436,-0.044,-0.165,-0.539,-0.590,-1.123,-2.028},
	{-0.722,-0.850,-0.704,-0.371,-0.308,-0.499,1.140,0.846,0.788,0.490,0.408,0.418,-0.045,-0.089,-0.415,-0.478,-0.963,-2.033},
	{-0.322,-0.332,-0.371,-0.016,0.205,-0.059,1.414,1.075,1.152,0.831,0.758,0.649,0.383,0.241,-0.073,-0.166,-0.650,-1.650},
	{-0.331,-0.365,-0.308,0.205,0.182,-0.009,1.502,1.385,1.192,0.912,0.872,0.943,0.434,0.392,-0.062,-0.021,-0.342,-1.212},
	{-0.603,-0.531,-0.499,-0.059,-0.009,-0.469,1.310,1.010,0.859,0.671,0.591,0.565,0.122,0.000,-0.438,-0.533,-1.034,-1.800},
	{1.147,1.139,1.140,1.414,1.502,1.310,3.018,2.911,1.157,2.635,1.848,2.699,1.587,1.557,1.004,1.340,1.252,0.700},
	{0.937,0.918,0.846,1.075,1.385,1.010,2.911,2.811,0.989,2.439,1.622,2.525,1.361,1.277,0.685,0.938,0.814,0.411},
	{0.752,0.852,0.788,1.152,1.192,0.859,1.157,0.989,1.978,0.695,1.386,0.641,1.002,0.642,0.618,0.894,0.792,-0.029},
	{0.502,0.452,0.490,0.831,0.912,0.671,2.635,2.439,0.695,1.589,1.395,1.515,1.022,0.948,0.457,0.707,0.586,0.021},
	{0.405,0.445,0.408,0.758,0.872,0.591,1.848,1.622,1.386,1.395,1.300,1.283,0.931,0.829,0.484,0.633,0.389,-0.046},
	{0.495,0.436,0.418,0.649,0.943,0.565,2.699,2.525,0.641,1.515,1.283,1.309,0.921,0.777,0.265,0.484,0.274,-0.253},
	{-0.116,-0.044,-0.045,0.383,0.434,0.122,1.587,1.361,1.002,1.022,0.931,0.921,0.559,0.319,0.301,0.212,-0.155,-0.949},
	{-0.092,-0.165,-0.089,0.241,0.392,0.000,1.557,1.277,0.642,0.948,0.829,0.777,0.319,-0.301,-0.159,-0.132,-0.338,-1.324},
	{-0.412,-0.539,-0.415,-0.073,-0.062,-0.438,1.004,0.685,0.618,0.457,0.484,0.265,0.301,-0.159,-0.314,-0.478,-0.964,-1.410},
	{-0.499,-0.590,-0.478,-0.166,-0.021,-0.533,1.340,0.938,0.894,0.707,0.633,0.484,0.212,-0.132,-0.478,-0.687,-1.240,-1.784},
	{-1.005,-1.123,-0.963,-0.650,-0.342,-1.034,1.252,0.814,0.792,0.586,0.389,0.274,-0.155,-0.338,-0.964,-1.240,-1.873,-2.402},
	{-2.060,-2.028,-2.033,-1.650,-1.212,-1.800,0.700,0.411,-0.029,0.021,-0.046,-0.253,-0.949,-1.324,-1.410,-1.784,-2.402,-3.742}
};

void compute_energy(vector<atom>&, vector<atom>&);
soroban_score compute_energy(vector< vector<atom> >& proteins, double* weights);

#endif
